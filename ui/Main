local CoreGui = game:GetService("CoreGui")
local UserInput = game:GetService("UserInputService")
local HttpService = game:GetService("HttpService")

local Interface = import("rbxassetid://11389137937")

if oh.Cache["ui/Main"] then
	return Interface
end

-- Загрузка контроллеров интерфейса
import("ui/Controls/TabSelector")
local MessageBox, MessageType = import("ui/Controls/MessageBox")

local RemoteSpy
local ClosureSpy
local ScriptScanner
local ModuleScanner
local UpvalueScanner
local ConstantScanner

xpcall(function()
    -- Здесь я также исправил 'modules' на 'Modules', так как на GitHub у тебя большая буква
	RemoteSpy = import("ui/Modules/RemoteSpy")
	ClosureSpy = import("ui/Modules/ClosureSpy")
	ScriptScanner = import("ui/Modules/ScriptScanner")
	ModuleScanner = import("ui/Modules/ModuleScanner")
	UpvalueScanner = import("ui/Modules/UpvalueScanner")
	ConstantScanner = import("ui/Modules/ConstantScanner")
end, function(err)
    -- Если всё равно будет ошибка, она выведется в MessageBox
	warn("<OH> Ошибка загрузки модулей: " .. err)
end)
end)

local constants = {
	opened = UDim2.new(0.5, -325, 0.5, -175),
	closed = UDim2.new(0.5, -325, 0, -400),
	reveal = UDim2.new(0.5, -15, 0, 20),
	conceal = UDim2.new(0.5, -15, 0, -75)
}

local Open = Interface.Open
local Base = Interface.Base
local Drag = Base.Drag
local Status = Base.Status
local Collapse = Drag.Collapse

function oh.setStatus(text)
	Status.Text = '• Status: ' .. text
end

local dragging, dragStart, startPos

Drag.InputBegan:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.MouseButton1 then
		dragging = true
		dragStart = input.Position
		startPos = Base.Position
		input.Changed:Connect(function()
			if input.UserInputState == Enum.UserInputState.End then dragging = false end
		end)
	end
end)

oh.Events.Drag = UserInput.InputChanged:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.MouseMovement and dragging then
		local delta = input.Position - dragStart
		Base.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
	end
end)

Open.MouseButton1Click:Connect(function()
	Open:TweenPosition(constants.conceal, "Out", "Quad", 0.15)
	Base:TweenPosition(constants.opened, "Out", "Quad", 0.15)
end)

Collapse.MouseButton1Click:Connect(function()
	Base:TweenPosition(constants.closed, "Out", "Quad", 0.15)
	Open:TweenPosition(constants.reveal, "Out", "Quad", 0.15)
end)

Interface.Name = HttpService:GenerateGUID(false)
Interface.Parent = (getHui and getHui()) or CoreGui

return Interface
